#include <stdio.h>
void yuusen(int a,int b);

int connect[100][100],connecter[100];
int thisNO[100];

int main (void){
    int n;
    int bangou,yazirusi;
    int loop,loop_in_loop;//???????????°?????????,????????????????????????????????????
    
    scanf("%d",&n);//????????°????????????
    for(loop=0;loop<n;loop++){//????????¨?????????????????\???????????????loop+1??§??????
        scanf("%d %d",&bangou,&yazirusi);
        //??\?¶????????????????
        for(loop_in_loop=0;loop_in_loop<yazirusi;loop_in_loop++){
            scanf("%d",&connect[loop][loop_in_loop]);//???????????????????????????
        }
        connecter[loop]=yazirusi;//??????????????¢??°?????°???connecter[loop]??§loop+1?????????????????¢??°?????°??????????????????
    }
    //?????????
    for(loop=0;loop<n;loop++){
        thisNO[loop]=10000;
    }
    
    //????????¢?´¢????§?
    yuusen(1,0);
    
    //??????
    for(loop=0;loop<n;loop++){
        printf("%d %d\n",loop+1,thisNO[loop]);
    }
    
    return 0;
}

void yuusen(int no,int bangou){//???????????????????????????
    int loop;
    if(connecter[no-1]==0){//?????????????????????????????´???
    }else{//??????????????´???
        for(loop=0;loop<connecter[no-1];loop++){
            //if(thisNO[connect[no-1][loop]]>9999){//??\????????¨???????????´?????????
                yuusen(connect[no-1][loop],bangou+1);
            //}
        }
    }
    //????????????????????¢????¨????
    if(thisNO[no-1]>bangou){
        thisNO[no-1]=bangou;
    }
    return;
}